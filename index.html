<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Super App | Construtor de Relat√≥rios</title>
   <script src="https://cdn.tailwindcss.com"></script>
<script>
  tailwind.config = {
    darkMode: 'class',
  }
</script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>
    
    <link rel="stylesheet" href="style.css">
</head>
<body class="bg-gray-50">

    <div id="loading-overlay" class="fixed inset-0 bg-gray-100 flex items-center justify-center z-50 hidden">
        <div class="text-xl font-semibold text-gray-700">Carregando...</div>
    </div>

    <div id="login-screen" class="fixed inset-0 flex items-center justify-center p-4 bg-gray-100/90 z-40">
        <div class="w-full max-w-sm">
            <div class="text-center mb-8">
                <h1 class="text-4xl font-extrabold text-gray-900">Super App</h1>
                <p class="text-gray-500 mt-2 text-lg">Construtor de Relat√≥rios Inteligente</p>
            </div>

            <div class="bg-white p-8 rounded-xl shadow-lg transition-all duration-300 card">
                
                <form id="login-form" class="space-y-6">
                    <div>
                        <label for="username" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Email</label>
                        <input type="email" id="username" value="admin" required 
                                class="form-input text-gray-800" placeholder="Digite seu email">
                    </div>
                    
                    <div>
                        <label for="password" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Senha</label>
                        <div id="password-input-wrapper" class="relative">
                            <input type="password" id="password" value="admin" required 
                                    class="form-input text-gray-800 pr-10">
                            </div>
                    </div>

                    <p id="login-error" class="text-sm font-medium text-red-600 hidden">Usu√°rio/senha incorretos.</p>

                    <button type="submit" 
                            class="btn btn-primary w-full text-lg shadow-md">
                        <i data-lucide="log-in" class="w-5 h-5"></i> Entrar
                    </button>
                </form>

                <div class="mt-6">
                    <div class="relative">
                        <div class="absolute inset-0 flex items-center"><div class="w-full border-t border-gray-300 dark:border-gray-600"></div></div>
                        <div class="relative flex justify-center text-sm"><span class="px-2 bg-white dark:bg-dark text-gray-500">Ou</span></div>
                    </div>

                    </div>
                
                <p class="text-center text-sm text-gray-500 dark:text-gray-400 mt-6">
                    Use <strong class="text-blue-600">admin/admin</strong> para login local de teste.
                </p>
                <div id="request-access-link" class="text-center mt-3 hidden">
                    <a href="#" class="text-sm text-blue-600 hover:underline">Solicitar Acesso</a>
                </div>
            </div>
            
        </div>
    </div>

    <div id="main-app-view" class="app-layout hidden">
        
        <div id="sidebar" class="sidebar flex flex-col justify-between">
            <div>
                <div class="text-2xl font-bold text-gray-900 dark:text-white mb-6">Super App</div>
                
                <nav id="main-nav" class="space-y-1">
                    <div class="nav-item active" data-page="dashboard"><i data-lucide="layout-dashboard" class="w-5 h-5"></i> <span>Dashboard</span></div>
                    <div class="nav-item" data-page="create-report"><i data-lucide="file-plus" class="w-5 h-5"></i> <span>Criar Relat√≥rio</span></div>
                    <div class="nav-item" data-page="fill-report"><i data-lucide="edit" class="w-5 h-5"></i> <span>Preencher Relat√≥rio</span></div>
                    <div class="nav-item" data-page="analysis"><i data-lucide="bar-chart-3" class="w-5 h-5"></i> <span>An√°lise</span></div>
                    <div class="nav-item" data-page="users"><i data-lucide="users" class="w-5 h-5"></i> <span>Usu√°rios</span></div>
                </nav>
            </div>

            <div class="pt-4 border-t border-gray-200 dark:border-gray-700">
                <div id="user-info-sidebar" class="flex items-center gap-3 mb-2">
                    <img id="user-avatar-sidebar" src="https://placehold.co/32x32/E0E7FF/334155?text=?" alt="Avatar" class="w-8 h-8 rounded-full">
                    <div>
                        <p id="user-name-sidebar" class="font-semibold text-sm dark:text-white">Usu√°rio</p>
                        <p id="user-email-sidebar" class="text-xs text-gray-500 dark:text-gray-400">email@app.com</p>
                    </div>
                </div>
                <button id="logout-btn" class="nav-item text-red-500 dark:text-red-400 w-full mt-2">
                    <i data-lucide="log-out" class="w-5 h-5"></i> <span>Sair</span>
                </button>
            </div>
        </div>

        <div id="app-screen" class="main-content">
            <header class="flex items-center justify-between border-b border-gray-200 dark:border-gray-700 pb-4 mb-8">
                <h1 id="page-title" class="text-3xl font-extrabold text-gray-900 dark:text-white">Dashboard</h1>
                
                <div class="flex items-center gap-4">
                    <div id="theme-toggle" class="toggle flex items-center p-0.5" role="switch" title="Alternar Modo Escuro">
                        <i data-lucide="sun" class="w-4 h-4 text-gray-500 dark:text-gray-300"></i>
                    </div>

                    <button id="menu-toggle" class="lg:hidden text-gray-600 dark:text-gray-400 p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800">
                        <i data-lucide="menu" class="w-6 h-6"></i>
                    </button>
                    
                    <div class="relative">
                        <button id="notification-bell-button" class="text-gray-600 dark:text-gray-400 p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 relative">
                            <i data-lucide="bell" class="w-6 h-6"></i>
                            <span id="notification-dot" class="absolute top-2 right-2 block h-3 w-3 rounded-full ring-2 ring-white bg-red-500 dark:ring-dark hidden"></span>
                        </button>
                        <div id="notification-dropdown" class="absolute hidden">
                            <div id="notification-list" class="divide-y divide-gray-100 dark:divide-gray-800 max-h-80 overflow-y-auto">
                                </div>
                            <div id="notification-empty-state" class="p-4 text-center text-sm text-gray-500">
                                Nenhuma notifica√ß√£o.
                            </div>
                        </div>
                    </div>
                </div>
            </header>
            
            <div id="page-content">
                
                <div id="page-dashboard" class="page">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div class="card p-6">
                            <h2 class="text-xl font-semibold mb-3 dark:text-white">Vis√£o Geral</h2>
                            <p class="text-gray-700 dark:text-gray-400">O Dashboard ser√° preenchido com estat√≠sticas de uso e relat√≥rios pendentes.</p>
                            
                            <div id="admin-only-content" class="mt-4 p-3 border-l-4 border-red-500 bg-red-100 dark:bg-red-900/50 hidden">
                                <p class="text-red-800 dark:text-red-200 font-medium">üö® √Årea de Administrador Ativa</p>
                                <p class="text-sm text-red-700 dark:text-red-300">Voc√™ tem permiss√£o total sobre todos os modelos e usu√°rios.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="page-create-report" class="page hidden">
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <div class="lg:col-span-1 space-y-4">
                            <h3 class="text-xl font-bold dark:text-white">Componentes</h3>
                            <div class="grid grid-cols-2 gap-4">
                                <div class="component-type" data-type="text"><i data-lucide="type" class="w-6 h-6 text-blue-500"></i><span class="mt-2 text-sm font-medium">Texto Curto</span></div>
                                <div class="component-type" data-type="textarea"><i data-lucide="align-left" class="w-6 h-6 text-blue-500"></i><span class="mt-2 text-sm font-medium">Texto Longo</span></div>
                                <div class="component-type" data-type="checkbox"><i data-lucide="check-square" class="w-6 h-6 text-purple-500"></i><span class="mt-2 text-sm font-medium">Sele√ß√£o</span></div>
                                <div class="component-type" data-type="select"><i data-lucide="list" class="w-6 h-6 text-green-500"></i><span class="mt-2 text-sm font-medium">Lista Suspensa</span></div>
                                <div class="component-type" data-type="table"><i data-lucide="table" class="w-6 h-6 text-indigo-500"></i><span class="mt-2 text-sm font-medium">Tabela</span></div>
                                <div class="component-type" data-type="date"><i data-lucide="calendar" class="w-6 h-6 text-red-500"></i><span class="mt-2 text-sm font-medium">Data</span></div>
                                <div class="component-type" data-type="image"><i data-lucide="image" class="w-6 h-6 text-yellow-500"></i><span class="mt-2 text-sm font-medium">Imagem</span></div>
                                
                                <div class="component-type" data-type="file"><i data-lucide="paperclip" class="w-6 h-6 text-orange-500"></i><span class="mt-2 text-sm font-medium">Anexar Arquivo</span></div>
                            </div>
                        </div>

                        <div class="lg:col-span-2 space-y-6">
                            <div class="card p-6">
                                <h3 class="text-xl font-bold dark:text-white mb-4">Configura√ß√£o do Modelo</h3>
                                <input type="hidden" id="editing-report-id" value="">
                                <label for="report-title" class="block text-sm font-medium dark:text-gray-300 mb-1">T√≠tulo do Relat√≥rio</label>
                                <input type="text" id="report-title" class="form-input text-xl font-bold mb-6" placeholder="Ex: Relat√≥rio Di√°rio de Obra">

                                <div class="grid grid-cols-2 gap-6">
                                    <div>
                                        <h4 class="font-semibold mb-3 dark:text-gray-200">Estrutura (Arraste e Solte)</h4>
                                        <div id="report-builder-area" class="space-y-3 p-4 bg-gray-50 dark:bg-gray-800 rounded-xl min-h-[300px] border-2 border-dashed border-gray-200 dark:border-gray-700">
                                            <div class="text-center py-10 text-gray-500 dark:text-gray-400">
                                                <i data-lucide="layout-template" class="w-12 h-12 mx-auto mb-3 opacity-50"></i>
                                                <p>Clique ou arraste componentes</p>
                                            </div>
                                        </div>
                                    </div>

                                    <div>
                                        <h4 class="font-semibold mb-3 dark:text-gray-200">Pr√©-visualiza√ß√£o</h4>
                                        <div class="p-4 bg-white dark:bg-dark border rounded-xl dark:border-gray-700 shadow-inner">
                                            <h5 id="preview-title" class="text-xl font-extrabold mb-4 text-center dark:text-white">T√≠tulo do Relat√≥rio</h5>
                                            <div id="report-preview-area" class="space-y-4">
                                                <p class="text-gray-500 dark:text-gray-400 text-center py-10">Preview vazio</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="flex gap-4 mt-6 border-t pt-4">
                                    <button id="save-report-btn" class="btn btn-primary"><i data-lucide="save" class="w-5 h-5"></i> Salvar Relat√≥rio</button>
                                    <button id="cancel-edit-btn" class="btn btn-dark hidden"><i data-lucide="x" class="w-5 h-5"></i> Cancelar Edi√ß√£o</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="page-fill-report" class="page hidden">
                    <h2 class="text-xl font-semibold mb-4 dark:text-white">Modelos Dispon√≠veis</h2>
                    <div id="saved-reports-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        </div>
                </div>
                
                <div id="page-analysis" class="page hidden">
                    <div id="drafts-list-container" class="mb-8 hidden">
                        <h2 class="text-xl font-semibold mb-4 text-yellow-800 dark:text-yellow-300">Rascunhos Pendentes</h2>
                        <div id="drafts-list" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            </div>
                    </div>

                    <h2 class="text-xl font-semibold mb-4 dark:text-white">Relat√≥rios Preenchidos</h2>
                    <div id="filled-reports-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        </div>
                </div>

                <div id="page-users" class="page hidden">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-semibold dark:text-white">Gerenciamento de Usu√°rios</h2>
                        <button id="add-user-btn" class="btn btn-primary"><i data-lucide="user-plus" class="w-5 h-5"></i> Adicionar Usu√°rio</button>
                    </div>

                    <div id="pending-users-container" class="card p-4 mb-8 hidden">
                        <h3 class="text-lg font-semibold text-yellow-600 dark:text-yellow-300 mb-3 flex items-center gap-2"><i data-lucide="hourglass" class="w-5 h-5"></i> Solicita√ß√µes Pendentes</h3>
                        <div class="overflow-x-auto">
                            <table class="min-w-full text-sm">
                                <thead class="border-b dark:border-gray-700">
                                    <tr>
                                        <th class="text-left py-2 px-4">Nome</th>
                                        <th class="text-left py-2 px-4">Email</th>
                                        <th class="text-center py-2 px-4">A√ß√µes</th>
                                    </tr>
                                </thead>
                                <tbody id="pending-users-table-body">
                                    </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="card p-6 overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                            <thead class="bg-gray-50 dark:bg-gray-800">
                                <tr>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Usu√°rio</th>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Email</th>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Perfil</th>
                                    <th class="px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody id="users-table-body" class="bg-white dark:bg-dark divide-y divide-gray-200 dark:divide-gray-700">
                                </tbody>
                        </table>
                    </div>
                </div>
                
            </div>
        </div>
        
    </div>

    <div id="confirm-modal" class="modal-overlay">
        <div class="modal">
            <div class="p-6">
                <h3 id="confirm-modal-title" class="text-xl font-bold dark:text-white mb-4">Confirmar A√ß√£o</h3>
                <p id="confirm-modal-message" class="text-gray-700 dark:text-gray-400 mb-6">Voc√™ tem certeza que deseja prosseguir?</p>
                <div class="flex justify-end gap-3">
                    <button id="confirm-modal-cancel" class="btn btn-secondary"><i data-lucide="x" class="w-5 h-5"></i> Cancelar</button>
                    <button id="confirm-modal-confirm" class="btn btn-danger"><i data-lucide="check" class="w-5 h-5"></i> Confirmar</button>
                </div>
            </div>
        </div>
    </div>

    <div id="component-modal" class="modal-overlay">
        <div class="modal max-w-lg">
            <div class="p-6">
                <h3 id="component-modal-title" class="text-xl font-bold dark:text-white mb-4">Editar Componente</h3>
                <form id="component-form" class="space-y-4">
                    <input type="hidden" id="component-id">
                    
                    <div>
                        <label for="component-label" class="block text-sm font-medium dark:text-gray-300">R√≥tulo do Campo</label>
                        <input type="text" id="component-label" class="form-input" required>
                    </div>

                    <div class="flex items-center gap-4">
                        <label for="component-required" class="text-sm font-medium dark:text-gray-300">Obrigat√≥rio?</label>
                        <div id="component-required-toggle" class="toggle">
                            <input type="checkbox" id="component-required" class="hidden">
                        </div>
                    </div>

                    <div id="component-options-container" class="hidden">
                        <label for="component-options" class="block text-sm font-medium dark:text-gray-300">Op√ß√µes (uma por linha)</label>
                        <textarea id="component-options" class="form-input" rows="4" placeholder="Ex: Op√ß√£o A\nOp√ß√£o B\nOp√ß√£o C"></textarea>
                    </div>

                    <div id="component-single-selection-container" class="hidden">
                        <div class="flex items-center gap-4">
                            <label for="component-single-selection" class="text-sm font-medium dark:text-gray-300">Permitir Apenas 1 Sele√ß√£o (Radio)</label>
                            <div id="component-single-selection-toggle" class="toggle">
                                <input type="checkbox" id="component-single-selection" class="hidden">
                            </div>
                        </div>
                    </div>

                    <div id="component-columns-container" class="hidden">
                        <label for="component-columns" class="block text-sm font-medium dark:text-gray-300">Colunas da Tabela (uma por linha)</label>
                        <textarea id="component-columns" class="form-input" rows="3" placeholder="Ex: Item\nQuantidade\nObserva√ß√£o"></textarea>
                    </div>

                    <div class="flex justify-end gap-3 pt-4">
                        <button type="button" id="cancel-component-btn" class="btn btn-secondary">Cancelar</button>
                        <button type="submit" class="btn btn-primary">Salvar Componente</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div id="fill-report-modal" class="modal-overlay">
        <div class="modal max-w-4xl">
            <div class="p-6">
                <h3 id="fill-report-modal-title" class="text-2xl font-bold dark:text-white mb-2">Preencher Relat√≥rio: T√≠tulo</h3>
                <form id="fill-report-form" class="space-y-6">
                    <p class="text-gray-500">Carregando campos...</p>

                    <div class="flex justify-end gap-3 pt-4 border-t dark:border-gray-700">
                        <button type="button" id="save-draft-btn-modal" class="btn btn-warning"><i data-lucide="save" class="w-5 h-5"></i> Salvar Rascunho</button>
                        <button type="button" id="cancel-fill-report-btn-modal" class="btn btn-dark">Cancelar</button>
                        <button type="submit" class="btn btn-primary"><i data-lucide="send" class="w-5 h-5"></i> Enviar Relat√≥rio</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div id="view-report-modal" class="modal-overlay">
        <div class="modal max-w-4xl">
            <div class="p-6">
                <h3 id="view-report-modal-title" class="text-2xl font-bold dark:text-white mb-2">Visualizar Relat√≥rio: T√≠tulo</h3>
                <div class="text-sm text-gray-500 mb-6">
                    Preenchido por <span id="view-report-filled-by" class="font-medium"></span> em <span id="view-report-filled-at"></span>
                </div>
                <div id="view-report-content" class="space-y-6 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg">
                    </div>
                <div class="flex justify-end gap-3 pt-4 mt-6 border-t dark:border-gray-700">
                    <button type="button" id="close-view-report-btn" class="btn btn-dark">Fechar</button>
                </div>
            </div>
        </div>
    </div>

    <div id="user-modal" class="modal-overlay">
        <div class="modal max-w-lg">
            <div class="p-6">
                <h3 id="user-modal-title" class="text-xl font-bold dark:text-white mb-4">Adicionar Usu√°rio</h3>
                <form id="user-form" class="space-y-4">
                    <input type="hidden" id="user-id" value="">
                    
                    <div>
                        <label for="user-name" class="block text-sm font-medium dark:text-gray-300">Nome Completo</label>
                        <input type="text" id="user-name" class="form-input" required>
                    </div>
                    
                    <div>
                        <label for="user-email" class="block text-sm font-medium dark:text-gray-300">Email</label>
                        <input type="email" id="user-email" class="form-input" required>
                    </div>

                    <div id="password-field-container">
                        <label for="user-password" class="block text-sm font-medium dark:text-gray-300">Senha (Obrigat√≥ria para Novos)</label>
                        <div class="relative">
                            <input type="password" id="user-password" class="form-input pr-10" minlength="6" placeholder="M√≠nimo 6 caracteres">
                            <button type="button" id="toggle-password-visibility" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700">
                                <i data-lucide="eye" class="w-5 h-5"></i>
                            </button>
                        </div>
                    </div>

                    <div>
                        <label for="user-profile" class="block text-sm font-medium dark:text-gray-300">Perfil</label>
                        <select id="user-profile" class="form-input">
                            <option value="user">Usu√°rio (Preenche Relat√≥rios)</option>
                            <option value="analyst">Analista (V√™ An√°lises)</option>
                            <option value="admin">Admin (Tudo)</option>
                        </select>
                    </div>

                    <div class="pt-2">
                        <h4 class="font-semibold text-gray-700 dark:text-gray-200 mb-2">Permiss√µes Espec√≠ficas:</h4>
                        <div class="space-y-2 text-sm">
                            <label class="flex items-center gap-3">
                                <input type="checkbox" data-permission="canViewDashboard" checked class="rounded text-blue-500">
                                <span>Ver Dashboard</span>
                            </label>
                            <label class="flex items-center gap-3">
                                <input type="checkbox" data-permission="canCreateReports" class="rounded text-blue-500">
                                <span>Criar/Editar Modelos de Relat√≥rio</span>
                            </label>
                            <label class="flex items-center gap-3">
                                <input type="checkbox" data-permission="canFillReports" checked class="rounded text-blue-500">
                                <span>Preencher Relat√≥rios</span>
                            </label>
                            <label class="flex items-center gap-3">
                                <input type="checkbox" data-permission="canViewAnalysis" class="rounded text-blue-500">
                                <span>Ver An√°lises e Rascunhos</span>
                            </label>
                            <label class="flex items-center gap-3">
                                <input type="checkbox" data-permission="canManageUsers" class="rounded text-blue-500">
                                <span>Gerenciar Usu√°rios (Admin)</span>
                            </label>
                        </div>
                    </div>

                    <div class="flex justify-end gap-3 pt-4">
                        <button type="button" id="cancel-user-btn" class="btn btn-secondary">Cancelar</button>
                        <button type="submit" class="btn btn-primary">Salvar Usu√°rio</button>
                    </div>
                </form>
            </div>
        </div>
    </div>


    <div id="toast" class="toast">
        <i data-lucide="check-circle" class="w-5 h-5 text-green-500"></i>
        <span id="toast-message" class="text-sm font-medium dark:text-white">Mensagem</span>
    </div>

    <script type="module" src="app.js"></script>

</body>
</html>